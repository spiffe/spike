#    \\ SPIKE: Secure your secrets with SPIFFE.
#  \\\\\ Copyright 2024-present SPIKE contributors.
# \\\\\\\ SPDX-License-Identifier: Apache-2.0

# Individual LoadBalancer service for pod 0
apiVersion: v1
kind: Service
metadata:
  namespace: spike-system
  name: spike-keeper-0-external
  labels:
    app.kubernetes.io/name: spike-keeper
    app.kubernetes.io/component: keeper
    app.kubernetes.io/part-of: spike
    app.kubernetes.io/instance: "0"
spec:
  type: LoadBalancer
  ports:
  - port: 443
    targetPort: 8443
    name: api
  selector:
    app.kubernetes.io/name: spike-keeper
    app.kubernetes.io/component: keeper
    statefulset.kubernetes.io/pod-name: spike-keeper-0
---
# Individual LoadBalancer service for pod 1
apiVersion: v1
kind: Service
metadata:
  namespace: spike-system
  name: spike-keeper-1-external
  labels:
    app.kubernetes.io/name: spike-keeper
    app.kubernetes.io/component: keeper
    app.kubernetes.io/part-of: spike
    app.kubernetes.io/instance: "1"
spec:
  type: LoadBalancer
  ports:
  - port: 443
    targetPort: 8443
    name: api
  selector:
    app.kubernetes.io/name: spike-keeper
    app.kubernetes.io/component: keeper
    statefulset.kubernetes.io/pod-name: spike-keeper-1
---
# Individual LoadBalancer service for pod 2
apiVersion: v1
kind: Service
metadata:
  namespace: spike-system
  name: spike-keeper-2-external
  labels:
    app.kubernetes.io/name: spike-keeper
    app.kubernetes.io/component: keeper
    app.kubernetes.io/part-of: spike
    app.kubernetes.io/instance: "2"
spec:
  type: LoadBalancer
  ports:
  - port: 443
    targetPort: 8443
    name: api
  selector:
    app.kubernetes.io/name: spike-keeper
    app.kubernetes.io/component: keeper
    statefulset.kubernetes.io/pod-name: spike-keeper-2
